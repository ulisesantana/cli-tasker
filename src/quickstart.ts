
var GoogleSpreadsheet = require('google-spreadsheet');
var creds = require('../client_secret.json');
const fs = require('fs');

// Create a document object using the ID of the spreadsheet - obtained from its URL.
var doc = new GoogleSpreadsheet('10FkpqixukIY6sGgrxi1psVW8gzlS_GUpkk-MPx8YqBw');

var tasks = [{ "id": "0", "name": "Testing stuff", "date": "2017-09-25T11:10:52.294Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "33139473589464", "name": "Testing stuff", "date": "2017-09-25T11:41:48.612Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "138583253287248", "name": "Testing stuff", "date": "2017-09-25T11:41:49.644Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "60253588423440", "name": "Testing stuff", "date": "2017-09-25T11:41:50.586Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "46696531052036", "name": "Testing stuff", "date": "2017-09-25T11:41:51.356Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "21088755969736", "name": "Testing stuff", "date": "2017-09-25T11:41:52.124Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "78329665069864", "name": "Testing stuff", "date": "2017-09-25T11:41:52.883Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "76823325394416", "name": "Testing stuff", "date": "2017-09-25T11:41:53.616Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "119000837435309", "name": "Testing stuff", "date": "2017-09-25T11:41:54.371Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "137076914077922", "name": "Testing stuff", "date": "2017-09-25T11:41:55.142Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "13557057443082", "name": "Testing stuff", "date": "2017-09-25T11:41:55.898Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "147621292232190", "name": "Testing stuff", "date": "2017-09-25T11:41:56.655Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "15063397173930", "name": "Testing stuff", "date": "2017-09-25T11:41:57.393Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "10544378027036", "name": "Testing stuff", "date": "2017-09-25T11:41:58.148Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "37658492973100", "name": "Testing stuff", "date": "2017-09-25T11:41:58.924Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "54228229908624", "name": "Testing stuff", "date": "2017-09-25T11:41:59.684Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "141595933720608", "name": "Testing stuff", "date": "2017-09-25T11:42:00.432Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "138583254348100", "name": "Testing stuff", "date": "2017-09-25T11:42:01.176Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "73810646668717", "name": "Testing stuff", "date": "2017-09-25T11:42:07.933Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "120507178294880", "name": "Testing stuff", "date": "2017-09-25T11:42:08.686Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "146114953754419", "name": "Testing stuff", "date": "2017-09-25T11:42:09.427Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "15063397391720", "name": "Testing stuff", "date": "2017-09-25T11:42:19.172Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "15063397399150", "name": "Testing stuff", "date": "2017-09-25T11:42:19.915Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "54228230663148", "name": "Testing stuff", "date": "2017-09-25T11:42:20.643Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "76823326810686", "name": "Testing stuff", "date": "2017-09-25T11:42:21.387Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "129545217823524", "name": "Testing stuff", "date": "2017-09-25T11:42:22.134Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "61759929457670", "name": "Testing stuff", "date": "2017-09-25T11:42:22.870Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "147621294873388", "name": "Testing stuff", "date": "2017-09-25T11:42:23.606Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "102431102614712", "name": "Testing stuff", "date": "2017-09-25T11:42:24.334Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "33139474642032", "name": "Testing stuff", "date": "2017-09-25T11:42:36.456Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "24101436188032", "name": "Testing stuff", "date": "2017-09-25T11:42:41.752Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "15063397643660", "name": "Testing stuff", "date": "2017-09-25T11:42:44.367Z", "project": "Stuff", "ticket": "[STUFF-82] Full Testing", "tags": ["test", "stuff"], "tracks": null, "done": false, "iceboxed": false }, { "id": "34645930614590", "name": "Testing things", "date": "2017-09-25T13:06:49.330Z", "project": "Things", "ticket": "[THINGS-82] Full Testing", "tags": ["test", "things"], "tracks": null, "done": false, "iceboxed": false }]
console.log("Starting")
// Authenticate with the Google Spreadsheets API.
doc.useServiceAccountAuth(creds, function (err) {
  if (err) {
    console.log(err);
  }

  // tasks.forEach((task) => {
  //   doc.addRow(1, {
  //     taskId: task.id,
  //     name: task.name,
  //     date: task.date,
  //     project: task.project,
  //     ticket: task.ticket,
  //     tags: JSON.stringify(task.tags),
  //     tracks: JSON.stringify(task.tracks),
  //     done: task.done,
  //     iceboxed: task.iceboxed,
  //   }, function (err) {
  //     if (err) {
  //       console.log(err);
  //     }
  //   });
  // });
  // Get all of the rows from the spreadsheet.
  doc.getRows(1, function (err, rows) {
    if (err) {
      console.log(err);
    }
    fs.writeFileSync('./drive.json', JSON.stringify(rows));
  });
});
